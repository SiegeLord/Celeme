<?xml version="1.0" encoding="UTF-8"?>

<mechanism
	name = "DummyThresh"
>
	<external name = "V" />
	<threshold 
		state = "V"
		condition = "> 0"
		code = "delay = 15;"
		event_source="true"
		reset_dt="false"
	/>
</mechanism>

<mechanism
	name = "IzhMech"
	stage0 =
		"I = 0;"
	stage2 = "
		V' = (0.04f * V + 5) * V + 140 - u + I;
		u' = 0.01f * (0.2f * V - u);"
>
	<state name = "V" init = "-65" tolerance = "0.2" />
	<state name = "u" init = "-5" tolerance = "0.02" />
	<local name = "I" />
	<threshold 
		state = "V"
		condition = "> 0"
		code = "
			V = -65;
			u += 2;
			delay = 5;"
		event_source="true"
		reset_dt="true"
	/>
</mechanism>

<mechanism
	name = "IzhMech2"
	stage0 =
		"I = 0;"
	stage2 = "
		V' = (0.04f * V + 5) * V + 140 - u + I;
		u' = 0.02f * (0.2f * V - u);"
>
	<state name = "V" init = "-65" tolerance = "0.2" />
	<state name = "u" init = "-5" tolerance = "0.02" />
	<local name = "I" />
	<threshold 
		state = "V"
		condition = "> 0"
		code = "
			V = -50;
			u += 2;
			delay = 5;"
		event_source="true"
		reset_dt="true"
	/>
</mechanism>

<mechanism
	name = "IClamp"
	stage1 = "
		if(i % 2 == 0)
			I += amp + 3;
		else
			I += amp;"
>
	<external name = "I" />
	<constant name = "amp" />
</mechanism>

<mechanism
	name = "RandSyn"
	pre_stage = '
		if(cur_time == 0 && rand() > 0.7)
		{
			r += 0.02;
			reset_dt();
		}'
	stage1 = "
		I += r * (0 - V);"
	stage2 = "
		r' = -r / 2.0;"
>
	<external name = "I" />
	<external name = "V" />
	<state name = "r" tolerance = "0.01" />
</mechanism>

<synapse
	name = "ExpSyn"
	stage1 = "
		I += s * (E - V);"
	stage2 = "
		s' = -s / tau;"
	syn_code = '
		s += gsyn * weight;'
>
	<constant name = "gsyn" init = "0.1" />
	<constant name = "tau" init = "5" />
	<constant name = "E" init = "0" />
	<external name = "V" />
	<state name = "s" tolerance = "0.01" />
	<syn_global name = "weight" init = "1" readonly = "true" />
</synapse>

<neuron
	name = "Regular"
	record_length = "2000"
	record_rate = "100"
	circ_buffer_size = "10"
	num_src_synapses = "150"
	rand_state_len = "2"
	min_dt = "0.1"
>
	<mechanism name = "IzhMech" />
	<mechanism name = "IClamp" />
	<mechanism name = "RandSyn" />
	<synapse name = "ExpSyn" prefix = "glu" number = "150" />
	<connector name = "RandConn" />
	<synapse name = "ExpSyn" prefix = "gaba" number = "10" />
</neuron>

<neuron
	name = "Burster"
	record_length = "2000"
	record_rate = "100"
	circ_buffer_size = "10"
	num_src_synapses = "10"
	min_dt = "0.1"
>
	<mechanism name = "DummyThresh" prefix = "hl" />
	<mechanism name = "IzhMech2" />
	<mechanism name = "IClamp" />
	<synapse name = "ExpSyn" prefix = "glu" number = "100" />
	<synapse name = "ExpSyn" prefix = "gaba" number = "10" />
</neuron>

<connector
	name = "RandConn"
	code = '
	int dest = dest_start + cycle % (dest_end - dest_start);
	if(dest != i && rand() < P)
		connect(i, dest);'
>
	<constant name = "P" init="1" />
</connector>
